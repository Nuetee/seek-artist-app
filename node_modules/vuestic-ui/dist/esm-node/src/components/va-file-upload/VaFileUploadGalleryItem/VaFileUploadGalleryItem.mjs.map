{"version":3,"file":"VaFileUploadGalleryItem.mjs","sources":["../../../../../../src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue"],"sourcesContent":["<template>\n  <va-list-item\n    class=\"va-file-upload-gallery-item\"\n    :class=\"classesComputed\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n  >\n    <va-list-item-section v-if=\"removed && undo\">\n      <va-file-upload-undo vertical @recover=\"recoverImage\" />\n    </va-list-item-section>\n    <va-list-item-section v-else>\n      <img\n        v-if=\"previewImage\"\n        :src=\"previewImage\"\n        :alt=\"file.name || ''\"\n        class=\"va-file-upload-gallery-item__image\"\n      >\n      <div class=\"va-file-upload-gallery-item__overlay\">\n        <div\n          class=\"va-file-upload-gallery-item__overlay-background\"\n          :style=\"overlayStylesComputed\"\n        />\n        <div\n          v-if=\"file && file.name\"\n          class=\"va-file-upload-gallery-item__name\"\n          :title=\"file.name\"\n        >\n          {{ file.name }}\n        </div>\n        <va-button\n          flat\n          color=\"danger\"\n          icon=\"delete_outline\"\n          class=\"va-file-upload-gallery-item__delete\"\n          aria-label=\"remove image\"\n          @click=\"removeImage\"\n          @focus=\"onFocus\"\n          @blur=\"onBlur\"\n        />\n      </div>\n    </va-list-item-section>\n  </va-list-item>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, ref, watch, computed, PropType } from 'vue'\n\nimport { colorToRgba } from '../../../services/color-config/color-functions'\nimport { useFocus, useBem } from '../../../composables'\n\nimport type { ConvertedFile } from '../types'\n\nimport { VaButton, VaListItem, VaListItemSection } from '../../index'\nimport { VaFileUploadUndo } from '../VaFileUploadUndo'\n\nexport default defineComponent({\n  name: 'VaFileUploadGalleryItem',\n  components: {\n    VaFileUploadUndo,\n    VaButton,\n    VaListItem,\n    VaListItemSection,\n  },\n  emits: ['remove'],\n  props: {\n    file: { type: Object as PropType<ConvertedFile>, default: null },\n    color: { type: String, default: 'success' },\n    undo: { type: Boolean, default: false },\n    undoDuration: { type: Number, default: 3000 },\n  },\n  setup (props, { emit }) {\n    const { isFocused, onFocus, onBlur } = useFocus()\n    const previewImage = ref('')\n    const removed = ref(false)\n\n    const overlayStylesComputed = computed(() => ({\n      backgroundColor: colorToRgba(props.color, 0.7),\n    }))\n\n    const classesComputed = useBem('va-file-upload-gallery-item', () => ({\n      notImage: !previewImage.value,\n      focused: isFocused.value,\n      undo: removed.value,\n    }))\n\n    const removeImage = () => {\n      if (props.undo) {\n        removed.value = true\n\n        setTimeout(() => {\n          if (!removed.value) { return }\n\n          emit('remove')\n          removed.value = false\n        }, props.undoDuration)\n      } else {\n        emit('remove')\n        removed.value = false\n      }\n    }\n\n    const recoverImage = () => { removed.value = false }\n\n    const convertToImg = () => {\n      if (!props.file.name || !props.file.image) { return }\n\n      if (props.file.image.url) {\n        previewImage.value = props.file.image.url\n      } else if (props.file.image instanceof File) {\n        const reader = new FileReader()\n\n        reader.readAsDataURL(props.file.image)\n        reader.onload = (e) => {\n          if ((e.target?.result as string).includes('image')) {\n            previewImage.value = e.target?.result as string\n          }\n        }\n      }\n    }\n\n    onMounted(convertToImg)\n    watch(() => props.file, convertToImg)\n\n    return {\n      removed,\n      isFocused,\n      previewImage,\n      classesComputed,\n      overlayStylesComputed,\n\n      onBlur,\n      onFocus,\n      removeImage,\n      recoverImage,\n    }\n  },\n})\n</script>\n\n<style lang='scss'>\n@import \"variables\";\n@import \"../../../styles/resources\";\n\n$max-image-size: 8.5714rem;\n\n.va-file-upload-gallery-item {\n  display: flex;\n  position: relative;\n  margin-bottom: 1rem;\n  margin-right: 0.5rem;\n  flex-basis: calc(14.2857% - 0.5rem);\n  max-width: calc(14.2857% - 0.5rem);\n  min-width: $max-image-size;\n  border-radius: 0.375rem;\n  overflow: hidden;\n  width: 100%;\n  align-items: stretch;\n\n  @include media-breakpoint-down(md) {\n    flex-basis: calc(16.667% - 0.5rem);\n    max-width: calc(16.667% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(sm) {\n    flex-basis: calc(20% - 0.5rem);\n    max-width: calc(20% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(xs) {\n    flex-basis: calc(50% - 0.5rem);\n    max-width: calc(50% - 0.5rem);\n  }\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  &:hover,\n  &:focus,\n  &--focused {\n    .va-file-upload-gallery-item__overlay {\n      z-index: 3;\n      opacity: 1;\n    }\n\n    .va-file-upload-gallery-item {\n      &__name {\n        color: var(--va-file-upload-gallery-item-text-hover);\n      }\n    }\n  }\n\n  &__overlay {\n    display: flex;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    flex-direction: column;\n    padding: 0.5rem;\n    z-index: -1;\n    opacity: 0;\n  }\n\n  &__overlay-background {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n\n  &__image {\n    width: 100%;\n    box-shadow: var(--va-box-shadow);\n    object-fit: cover;\n    z-index: 1;\n  }\n\n  &__name {\n    color: var(--va-file-upload-gallery-item-text);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 0.875rem;\n  }\n\n  &__delete {\n    cursor: pointer;\n    font-size: 1.5rem;\n    margin-top: auto;\n  }\n\n  &--not-image {\n    .va-file-upload-gallery-item__overlay {\n      display: flex;\n    }\n  }\n\n  &--undo {\n    .va-list-item__inner {\n      display: flex;\n      align-items: flex-start;\n      position: relative;\n    }\n\n    .va-list-item-section {\n      height: inherit;\n      padding: 0;\n    }\n\n    .va-file-upload-undo {\n      flex: 1;\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","components","VaFileUploadUndo","VaButton","VaListItem","VaListItemSection","emits","props","file","type","Object","default","color","String","undo","Boolean","undoDuration","Number","setup","emit","isFocused","onFocus","onBlur","useFocus","previewImage","ref","removed","overlayStylesComputed","computed","backgroundColor","colorToRgba","classesComputed","useBem","notImage","value","focused","convertToImg","image","url","File","reader","FileReader","readAsDataURL","onload","e","target","_a","result","includes","_b","onMounted","watch","removeImage","setTimeout","recoverImage","_hoisted_2","class","_createBlock","_component_va_list_item","_normalizeClass","_ctx","_component_va_list_item_section","key","_withCtx","_createVNode","_component_va_file_upload_undo","vertical","onRecover","_createElementBlock","src","alt","_hoisted_1","_createCommentVNode","_createElementVNode","style","_normalizeStyle","title","_toDisplayString","_hoisted_3","_component_va_button","flat","icon","onClick"],"mappings":"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"}