var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,__defNormalProp=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r;import{defineComponent as s,shallowRef as i,ref as n,computed as u,onMounted as v,onBeforeUnmount as d,watch as c,resolveComponent as p,openBlock as m,createElementBlock as y,mergeProps as f,renderSlot as b,createCommentVNode as k,normalizeStyle as A,createTextVNode as g,toDisplayString as _,createVNode as h,createElementVNode as C,Fragment as w,renderList as L,normalizeClass as V,normalizeProps as x,guardReactiveProps as S}from"vue";import{p as $}from"../../../vendor.mjs";import{g as O}from"../../services/utils.mjs";import{u as B}from"../../composables/useArrayRefs.mjs";import{u as D}from"../../composables/useBem.mjs";import{u as E}from"../../composables/useColors.mjs";import"../../composables/usePopover.mjs";import{v as j}from"./validateSlider.mjs";import{V as P}from"../va-icon/index.mjs";import{_ as F}from"../../../plugin-vue_export-helper.mjs";const I=s({name:"VaSlider",components:{VaIcon:P},emits:["drag-start","drag-end","change","update:modelValue"],props:{range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},trackLabel:{type:[Function,String]},color:{type:String,default:"primary"},trackColor:{type:String,default:""},labelColor:{type:String,default:""},trackLabelVisible:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},label:{type:String,default:""},invertLabel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},pins:{type:Boolean,default:!1},iconPrepend:{type:String,default:""},iconAppend:{type:String,default:""},vertical:{type:Boolean,default:!1},showTrack:{type:Boolean,default:!0}},setup(e,{emit:s}){const{getColor:p,getHoverColor:m}=E(),y=i(),f=i(),{setItemRefByIndex:b,itemRefs:k}=B(),A=n(!1),g=n(!1),_=n(0),h=n(0),C=n(Array.isArray(e.modelValue)?[...e.modelValue]:e.modelValue),w=n(0),L=n(!1),V=u((()=>e.vertical?[1,0]:[0,1])),x=u((()=>e.vertical?"bottom":"left")),S=u((()=>e.vertical?"height":"width")),P=u((()=>Array.isArray(U.value)&&U.value[1]-e.step<U.value[0])),F=u((()=>Array.isArray(U.value)&&U.value[0]+e.step>U.value[1])),I=D("va-slider",(()=>{return s=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&__defNormalProp(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&__defNormalProp(e,l,a[l]);return e})({},$(e,["disabled","readonly","vertical"])),i={active:A.value,horizontal:!e.vertical,grabbing:L.value},a(s,l(i));var s,i})),R=D("va-slider__handler",(()=>({onFocus:!e.range&&(g.value||A.value),inactive:!A.value}))),M=u((()=>({color:e.labelColor?p(e.labelColor):p(e.color)}))),T=u((()=>({backgroundColor:e.trackColor?p(e.trackColor):m(p(e.color))}))),N=u((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return{[x.value]:`${l}%`,[S.value]:r-l+"%",backgroundColor:p(e.color),visibility:e.showTrack?"visible":"hidden"}}{const l=(a-e.min)/(e.max-e.min)*100;return{[S.value]:`${l}%`,backgroundColor:p(e.color),visibility:e.showTrack?"visible":"hidden"}}})),z=u((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return[{[x.value]:`${l}%`,backgroundColor:isActiveDot(0)?p(e.color):"#ffffff",borderColor:p(e.color)},{[x.value]:`${r}%`,backgroundColor:isActiveDot(1)?p(e.color):"#ffffff",borderColor:p(e.color)}]}{const l=(a-e.min)/(e.max-e.min)*100;return{[x.value]:`${l}%`,backgroundColor:isActiveDot(0)?p(e.color):"#ffffff",borderColor:p(e.color)}}})),U=u({get:()=>e.modelValue,set:a=>{e.range||(a=limitValue(a)),g.value||s("change",a),s("update:modelValue",a)}}),H=u((()=>{const a=(e.max-e.min)/e.step;return h.value/a})),J=u((()=>{const a=`${e.step}`.split(".")[1];return a?Math.pow(10,a.length):1})),W=u((()=>(e.max-e.min)/e.step-1)),X=u((()=>Array.isArray(e.modelValue)?[(e.modelValue[0]-e.min)/e.step*H.value,(e.modelValue[1]-e.min)/e.step*H.value]:(e.modelValue-e.min)/e.step*H.value)),Y=u((()=>[0,h.value])),q=u((()=>[e.min,e.max])),isActiveDot=a=>!(!A.value&&!g.value||e.disabled||e.readonly)&&(e.range?w.value===a:0===w.value),moving=a=>{L.value&&g.value&&!e.disabled&&!e.readonly&&(a.preventDefault(),setValueOnPos(getPos("touches"in a?a.touches[0]:a)))},moveEnd=()=>{if(!e.disabled&&!e.readonly){if(!g.value)return!1;s("drag-end"),s("change",e.modelValue),g.value=!1,L.value=!1}},moveWithKeys=a=>{var l,r;if(![k.value[0],k.value[1],f.value].includes(document.activeElement))return;if(e.disabled||e.readonly)return;const moveDot=(a,l,r)=>{if(a&&Array.isArray(U.value)){if(!e.pins)return U.value.splice(r,1,U.value[r]+(l?e.step:-e.step));const a=(e.max-e.min)/(W.value+1);let t=(U.value[r]/a|0)*a;U.value[r]!==t?(t+=l?a:0,U.value.splice(r,1,t)):U.value.splice(r,1,U.value[r]+(l?e.step:-e.step))}else{if(!e.pins&&!Array.isArray(U.value))return void(U.value+=l?e.step:-e.step);const a=(e.max-e.min)/(W.value+1);let r=(Array.isArray(U.value)?0:U.value/a|0)*a;U.value!==r?(r+=l?a:0,U.value=r):U.value+=l?e.step:-e.step}};["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(a.key)&&a.preventDefault();const isActive=e=>e===document.activeElement;if(e.range&&Array.isArray(U.value)){const isVerticalDot0More=a=>e.vertical&&isActive(k.value[0])&&"ArrowUp"===a.key,isVerticalDot0Less=a=>e.vertical&&isActive(k.value[0])&&"ArrowDown"===a.key,isVerticalDot1More=a=>e.vertical&&isActive(k.value[1])&&"ArrowUp"===a.key,isVerticalDot1Less=a=>e.vertical&&isActive(k.value[1])&&"ArrowDown"===a.key,isHorizontalDot0Less=a=>!e.vertical&&isActive(k.value[0])&&"ArrowLeft"===a.key,isHorizontalDot0More=a=>!e.vertical&&isActive(k.value[0])&&"ArrowRight"===a.key,isHorizontalDot1Less=a=>!e.vertical&&isActive(k.value[1])&&"ArrowLeft"===a.key,isHorizontalDot1More=a=>!e.vertical&&isActive(k.value[1])&&"ArrowRight"===a.key;switch(!0){case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&P.value&&U.value[0]!==e.min:null==(l=k.value[0])||l.focus(),moveDot(!0,0,0);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&F.value&&U.value[1]!==e.max:null==(r=k.value[1])||r.focus(),moveDot(!0,1,1);break;case(isVerticalDot0Less(a)||isHorizontalDot0Less(a))&&U.value[0]!==e.min:moveDot(!0,0,0);break;case(isVerticalDot1More(a)||isHorizontalDot1More(a))&&U.value[1]!==e.max:moveDot(!0,1,1);break;case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&U.value[1]!==e.min:moveDot(!0,0,1);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&U.value[0]!==e.max:moveDot(!0,1,0)}}else e.vertical?("ArrowDown"===a.key&&moveDot(!1,0,0),"ArrowUp"===a.key&&moveDot(!1,1,0)):("ArrowLeft"===a.key&&moveDot(!1,0,0),"ArrowRight"===a.key&&moveDot(!1,1,0))},checkActivePin=a=>Array.isArray(U.value)?a*e.step>U.value[0]&&a*e.step<U.value[1]:a*e.step<U.value,G=u((()=>e.step/(e.max-e.min)*100)),getPos=a=>(getStaticData(),e.vertical?_.value-a.clientY:a.clientX-_.value),getStaticData=()=>{y.value&&(h.value=y.value[e.vertical?"offsetHeight":"offsetWidth"],_.value=y.value.getBoundingClientRect()[x.value])},getValueByIndex=a=>(e.step*J.value*a+e.min*J.value)/J.value,setCurrentValue=a=>{const l=w.value;if(Array.isArray(U.value)&&Array.isArray(C.value)&&Array.isArray(e.modelValue))isDiff(C.value[l],a)&&(C.value.splice(l,1,a),0===l?(U.value=[C.value.splice(l,1,a)[0],e.modelValue[1]],C.value=[...U.value]):(U.value=[e.modelValue[0],C.value.splice(l,1,a)[0]],C.value=[...U.value]));else{if(a<e.min||a>e.max)return!1;isDiff(C.value,a)&&(C.value=a,U.value=a)}},setValueOnPos=a=>{const l=Y.value,r=q.value,t=Array.isArray(e.modelValue)?k.value[w.value]:f.value;if(null==t||t.focus(),a>=l[0]&&a<=l[1])if(w.value){Array.isArray(X.value)&&Array.isArray(U.value)&&a<=X.value[0]&&(U.value[1]=U.value[0],w.value=0);const e=getValueByIndex(Math.round(a/H.value));setCurrentValue(e)}else{Array.isArray(X.value)&&Array.isArray(U.value)&&a>=X.value[1]&&(U.value[0]=U.value[1],w.value=1);const e=getValueByIndex(Math.round(a/H.value));setCurrentValue(e)}else a<l[0]?setCurrentValue(r[0]):setCurrentValue(r[1])},limitValue=a=>{const inRange=a=>a<e.min?e.min:a>e.max?e.max:a;if(Array.isArray(a)){if(a[0]>=a[1]&&0===w.value){const e=inRange(a[1]);return[e,e]}if(a[0]>=a[1]&&1===w.value){const e=inRange(a[0]);return[e,e]}return a.map((e=>inRange(e)))}return inRange(a)},isDiff=(e,a)=>JSON.stringify(e)!==JSON.stringify(a),K=u((()=>`aria-label-id-${O()}`)),Q=u((()=>({role:"slider",ariaValuemin:e.min,ariaValuemax:e.max,ariaLabelledby:K.value,ariaOrientation:e.vertical?"vertical":"horizontal",ariaDisabled:e.disabled,ariaReadonly:e.readonly,ariaValuenow:Array.isArray(e.modelValue)?void 0:e.modelValue})));return v((()=>{j(e.modelValue,e.step,e.min,e.max,e.range)&&(getStaticData(),document.addEventListener("mousemove",moving),document.addEventListener("touchmove",moving,{passive:!1}),document.addEventListener("mouseup",moveEnd),document.addEventListener("mouseleave",moveEnd),document.addEventListener("touchcancel",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",moveWithKeys))})),d((()=>{document.removeEventListener("mousemove",moving),document.removeEventListener("touchmove",moving),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("mouseleave",moveEnd),document.removeEventListener("touchcancel",moveEnd),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",moveWithKeys)})),c([U,()=>e.step,()=>e.min,()=>e.max,()=>e.range],(([e,a,l,r,t])=>{j(e)})),c(L,(e=>{document.documentElement.style.cursor=e?"grabbing":""})),{getColor:p,dot:f,dots:k,setItemRefByIndex:b,orders:V,sliderContainer:y,val:U,getValueByOrder:a=>e.range&&void 0!==a?U.value[a]:U.value,sliderClass:I,dotClass:R,labelStyles:M,processedStyles:N,getPinStyles:a=>({backgroundColor:checkActivePin(a)?p(e.color):m(p(e.color)),[x.value]:a*G.value+"%",transition:L.value?"none":"var(--va-slider-pin-transition)"}),dottedStyles:z,getDottedStyles:a=>e.range&&void 0!==a?z.value[a]:z.value,clickOnContainer:a=>{if(e.disabled||e.readonly)return;const l=getPos("touches"in a?a.touches[0]:a);Array.isArray(X.value)&&(w.value=l>(X.value[1]-X.value[0])/2+X.value[0]?1:0),L.value=!0,setValueOnPos(l),((a,l=w.value)=>{var r,t;if(a.preventDefault(),!l)if(e.range){if(Array.isArray(X.value)){const e="touches"in a?a.touches[0]:a;l=getPos(e)>(X.value[1]-X.value[0])/2+X.value[0]?1:0}}else l=0;Array.isArray(e.modelValue)&&(w.value=l),Array.isArray(e.modelValue)?null==(r=k.value[l])||r.focus():null==(t=f.value)||t.focus(),g.value=!0,s("drag-start")})(a,w.value)},hasMouseDown:L,trackStyles:T,pinsCol:W,checkActivePin:checkActivePin,isFocused:A,isActiveDot:isActiveDot,getTrackLabel:(a,l)=>e.trackLabel?"function"==typeof e.trackLabel?e.trackLabel(a,l):e.trackLabel:a,currentSliderDotIndex:w,ariaLabelIdComputed:K,ariaAttributesComputed:Q}}}),R={key:0,class:"va-slider__input-wrapper","aria-hidden":"true"},M=["id"],T={key:2,class:"va-input__label","aria-hidden":"true"},N=["tabindex","onFocus"],z=["tabindex"],U={key:3,class:"va-input__label--inverse","aria-hidden":"true"},H={key:5,class:"va-slider__input-wrapper"};var J=F(I,[["render",function _sfc_render(e,a,l,r,t,o){const s=p("va-icon");return m(),y("div",f({class:["va-slider",e.sliderClass]},e.ariaAttributesComputed),[(e.vertical?e.$slots.append:e.$slots.prepend)?(m(),y("div",R,[b(e.$slots,e.vertical?"append":"prepend")])):k("",!0),!e.$slots.label&&!e.label||e.invertLabel?k("",!0):(m(),y("span",{key:1,class:"va-input__label",id:e.ariaLabelIdComputed,style:A(e.labelStyles)},[b(e.$slots,"label",{},(()=>[g(_(e.label),1)]))],12,M)),(e.vertical?e.iconAppend:e.iconPrepend)?(m(),y("span",T,[h(s,{name:e.vertical?e.iconAppend:e.iconPrepend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):k("",!0),C("div",{ref:"sliderContainer",class:"va-slider__container",onMousedown:a[3]||(a[3]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a)),onMouseup:a[4]||(a[4]=a=>e.hasMouseDown=!1),onTouchstart:a[5]||(a[5]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a))},[C("div",{class:"va-slider__track","aria-hidden":"true",style:A(e.trackStyles)},null,4),e.pins?(m(!0),y(w,{key:0},L(e.pinsCol,((a,l)=>(m(),y("div",{key:l,class:V(["va-slider__mark",{"va-slider__mark--active":e.checkActivePin(a)}]),style:A(e.getPinStyles(a))},null,6)))),128)):k("",!0),e.$props.range?(m(),y(w,{key:1},[C("div",{ref:"process",class:V(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),"aria-hidden":"true",style:A(e.processedStyles)},null,6),(m(!0),y(w,null,L(e.orders,(l=>(m(),y("div",{key:"dot"+l,ref_for:!0,ref:e.setItemRefByIndex(l),class:V(["va-slider__handler",e.dotClass]),style:A(e.getDottedStyles(l)),tabindex:e.disabled||e.readonly?void 0:0,onFocus:a=>(e.isFocused=!0,e.currentSliderDotIndex=l),onBlur:a[0]||(a[0]=a=>e.isFocused=!1)},[e.isActiveDot(l)?(m(),y("div",{key:0,style:A({backgroundColor:e.getColor(e.$props.color)}),class:"va-slider__handler__dot--focus"},null,4)):k("",!0),e.trackLabelVisible?(m(),y("div",{key:1,style:A(e.labelStyles),class:"va-slider__handler__dot--value"},[b(e.$slots,"trackLabel",x(S({value:e.getValueByOrder(l),order:l})),(()=>[g(_(e.getTrackLabel(e.getValueByOrder(l),l)),1)]))],4)):k("",!0)],46,N)))),128))],64)):(m(),y(w,{key:2},[C("div",{ref:"process","aria-hidden":"true",class:V(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),style:A(e.processedStyles)},null,6),C("div",{ref:"dot",class:V(["va-slider__handler",e.dotClass]),style:A(e.dottedStyles),tabindex:e.$props.disabled||e.$props.readonly?void 0:0,onFocus:a[1]||(a[1]=a=>e.isFocused=!0),onBlur:a[2]||(a[2]=a=>e.isFocused=!1)},[e.isActiveDot(0)?(m(),y("div",{key:0,class:"va-slider__handler__dot--focus",style:A({backgroundColor:e.getColor(e.$props.color)})},null,4)):k("",!0),e.trackLabelVisible?(m(),y("div",{key:1,class:"va-slider__handler__dot--value",style:A(e.labelStyles)},[b(e.$slots,"trackLabel",x(S({value:e.getValueByOrder()})),(()=>[g(_(e.getTrackLabel(e.getValueByOrder())),1)]))],4)):k("",!0)],46,z)],64))],544),(e.vertical?e.iconPrepend:e.iconAppend)?(m(),y("span",U,[h(s,{name:e.vertical?e.iconPrepend:e.iconAppend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):k("",!0),(e.$slots.label||e.label)&&e.invertLabel?(m(),y("span",{key:4,class:"va-input__label va-input__label--inverse",style:A(e.labelStyles)},[b(e.$slots,"label",{},(()=>[g(_(e.label),1)]))],4)):k("",!0),(e.vertical?e.$slots.prepend:e.$slots.append)?(m(),y("div",H,[b(e.$slots,e.vertical?"prepend":"append")])):k("",!0)],16)}]]);export{J as _};
//# sourceMappingURL=VaSlider.mjs.map

 import './VaSlider.css'