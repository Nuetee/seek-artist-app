{"version":3,"file":"VaDropdown.mjs","sources":["../../../../../src/components/va-dropdown/VaDropdown.vue"],"sourcesContent":["<template>\n  <div class=\"va-dropdown\" :class=\"computedClass\">\n    <div\n      ref=\"anchorRef\"\n      class=\"va-dropdown__anchor\"\n      role=\"button\"\n      aria-label=\"toggle dropdown\"\n      :aria-disabled=\"$props.disabled\"\n      :aria-expanded=\"!!valueComputed\"\n      :aria-controls=\"idComputed\"\n      @click=\"onAnchorClick\"\n      @mouseenter=\"onMouseEnter\"\n      @mouseleave=\"onMouseLeave\"\n    >\n      <slot name=\"anchor\" />\n    </div>\n    <template v-if=\"valueComputed\">\n      <teleport :to=\"attachElement\" :disabled=\"disableAttachment\">\n        <div\n          ref=\"contentRef\"\n          class=\"va-dropdown__content-wrapper\"\n          :id=\"idComputed\"\n          @mouseover=\"$props.isContentHoverable && onMouseEnter()\"\n          @mouseout=\"onMouseLeave\"\n          @click.stop=\"emitAndClose('dropdown-content-click', closeOnContentClick)\"\n        >\n          <slot />\n        </div>\n      </teleport>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType, shallowRef, toRef } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport { generateUniqueId } from '../../services/utils'\n\nimport {\n  useStateful, useStatefulEmits, useStatefulProps,\n  useDebounceFn,\n  usePopover, placementsPositions, Placement,\n  useClickOutside,\n  useBem,\n} from '../../composables'\n\nexport default defineComponent({\n  name: 'VaDropdown',\n\n  props: {\n    ...useStatefulProps,\n    stateful: { default: true },\n    modelValue: { type: Boolean, default: false },\n    disabled: { type: Boolean },\n    readonly: { type: Boolean },\n    anchorSelector: { type: String, default: '' },\n    attachElement: { type: String, default: 'body' },\n    disableAttachment: { type: Boolean, default: false },\n    keepAnchorWidth: { type: Boolean, default: false },\n    isContentHoverable: { type: Boolean, default: true },\n    closeOnContentClick: { type: Boolean, default: true },\n    closeOnClickOutside: { type: Boolean, default: true },\n    closeOnAnchorClick: { type: Boolean, default: true },\n    hoverOverTimeout: { type: Number, default: 30 },\n    hoverOutTimeout: { type: Number, default: 200 },\n    offset: { type: [Array, Number] as PropType<number | [number, number]>, default: 0 },\n    trigger: {\n      type: String as PropType<'click' | 'hover' | 'none'>,\n      default: 'click',\n      validator: (value: string) => ['click', 'hover', 'none'].includes(value),\n    },\n    placement: {\n      type: String as PropType<Placement>,\n      default: 'bottom',\n      validator: (value: string) => placementsPositions.includes(value),\n    },\n  },\n\n  emits: [...useStatefulEmits, 'anchor-click', 'dropdown-content-click', 'click-outside'],\n\n  setup (props, { emit }) {\n    const anchorRef = shallowRef<HTMLElement>()\n    const contentRef = shallowRef<HTMLElement>()\n\n    const { valueComputed: statefulVal } = useStateful(props, emit)\n    const valueComputed = computed({\n      get: () => statefulVal.value && !props.disabled && !props.readonly,\n      set (val) { statefulVal.value = val },\n    })\n\n    const computedClass = useBem('va-dropdown', () => pick(props, ['disabled']))\n\n    // to be able to select specific anchor element inside anchorRef\n    const computedAnchorRef = computed(() => (\n      anchorRef.value && props.anchorSelector\n        ? anchorRef.value.querySelector(props.anchorSelector) || anchorRef.value\n        : anchorRef.value\n      ) as HTMLElement | undefined)\n\n    usePopover(computedAnchorRef, contentRef, computed(() => ({\n      placement: props.placement,\n      keepAnchorWidth: props.keepAnchorWidth,\n      offset: props.offset,\n      stickToEdges: true,\n      autoPlacement: true,\n      root: props.attachElement,\n    })))\n\n    const { debounced: debounceHover, cancel: cancelHoverDebounce } = useDebounceFn(toRef(props, 'hoverOverTimeout'))\n    const onMouseEnter = () => {\n      if (props.trigger !== 'hover' || props.disabled) { return }\n\n      debounceHover(() => { valueComputed.value = true })\n      cancelUnHoverDebounce()\n    }\n\n    const { debounced: debounceUnHover, cancel: cancelUnHoverDebounce } = useDebounceFn(toRef(props, 'hoverOutTimeout'))\n    const onMouseLeave = () => {\n      if (props.trigger !== 'hover' || props.disabled) { return }\n\n      if (props.isContentHoverable) {\n        debounceUnHover(() => { valueComputed.value = false })\n      } else {\n        valueComputed.value = false\n      }\n      cancelHoverDebounce()\n    }\n\n    const emitAndClose = (eventName: string, close?: boolean) => {\n      emit(eventName)\n      if (close) { valueComputed.value = false }\n    }\n\n    const onAnchorClick = () => {\n      if (props.trigger !== 'click' || props.disabled) { return }\n\n      if (valueComputed.value) {\n        emitAndClose('anchor-click', props.closeOnAnchorClick)\n      } else {\n        valueComputed.value = true\n        emit('anchor-click')\n      }\n    }\n\n    useClickOutside([anchorRef, contentRef], () => {\n      if (props.closeOnClickOutside && valueComputed.value) {\n        emitAndClose('click-outside', props.closeOnClickOutside)\n      }\n    })\n\n    const idComputed = computed(generateUniqueId)\n\n    return {\n      valueComputed,\n      anchorRef,\n      contentRef,\n      computedClass,\n      emitAndClose,\n      onAnchorClick,\n      onMouseEnter,\n      onMouseLeave,\n      idComputed,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import '../../styles/resources';\n@import 'variables';\n\n.va-dropdown {\n  /* Solved the alignment problem (if we try to align inline and block elements) */\n  line-height: var(--va-dropdown-line-height);\n  font-family: var(--va-font-family);\n\n  &--disabled {\n    @include va-disabled;\n  }\n\n  &__content-wrapper {\n    /* overflow: hidden; */\n    z-index: var(--va-dropdown-content-wrapper-z-index);\n    font-family: var(--va-font-family);\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","props","useStatefulProps","stateful","default","modelValue","type","Boolean","disabled","readonly","anchorSelector","String","attachElement","disableAttachment","keepAnchorWidth","isContentHoverable","closeOnContentClick","closeOnClickOutside","closeOnAnchorClick","hoverOverTimeout","Number","hoverOutTimeout","offset","Array","trigger","validator","value","includes","placement","placementsPositions","emits","useStatefulEmits","setup","emit","anchorRef","shallowRef","contentRef","valueComputed","statefulVal","useStateful","computed","get","set","val","computedClass","useBem","pick","computedAnchorRef","querySelector","usePopover","stickToEdges","autoPlacement","root","debounced","debounceHover","cancel","cancelHoverDebounce","useDebounceFn","toRef","debounceUnHover","cancelUnHoverDebounce","emitAndClose","eventName","close","useClickOutside","idComputed","generateUniqueId","onAnchorClick","onMouseEnter","onMouseLeave","_createElementBlock","class","_normalizeClass","_ctx","_createElementVNode","ref","role","$props","onClick","_cache","args","onMouseenter","onMouseleave","_renderSlot","$slots","_hoisted_1","_createBlock","_Teleport","key","to","id","onMouseover","$event","onMouseout","_withModifiers","_hoisted_2"],"mappings":"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"}