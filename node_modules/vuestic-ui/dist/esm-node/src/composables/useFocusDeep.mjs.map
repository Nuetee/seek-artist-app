{"version":3,"file":"useFocusDeep.mjs","sources":["../../../../src/composables/useFocusDeep.ts"],"sourcesContent":["import { shallowRef, computed, Ref, onMounted } from 'vue'\nimport { useCaptureEvent } from './useCaptureEvent'\nimport { useCurrentElement } from './useCurrentElement'\n\nconst useActiveElement = () => {\n  const activeEl = shallowRef<HTMLElement>()\n\n  const updateActiveElement = () => {\n    activeEl.value = document.activeElement as HTMLElement\n  }\n\n  onMounted(updateActiveElement)\n\n  useCaptureEvent('focus', updateActiveElement)\n  useCaptureEvent('blur', updateActiveElement)\n\n  return activeEl\n}\n\nexport const useFocusDeep = (el?: Ref<HTMLElement | undefined>) => {\n  const focused = useActiveElement()\n  const current = useCurrentElement(el)\n  // Cache previouslyFocusedElement, so we can simply come back to it\n  let previouslyFocusedElement: HTMLElement | null = null\n\n  return computed<boolean | undefined>({\n    get () {\n      if (!focused.value) { return false }\n      if (focused.value === current.value) { return true }\n\n      const isFocused = current.value?.contains(focused.value)\n      if (isFocused) { previouslyFocusedElement = focused.value }\n      return isFocused\n    },\n    set (value) {\n      const target = previouslyFocusedElement ?? current.value\n      if (value) {\n        target?.focus()\n      } else {\n        target?.blur()\n      }\n    },\n  })\n}\n"],"names":["useFocusDeep","el","focused","activeEl","shallowRef","updateActiveElement","value","document","activeElement","onMounted","useCaptureEvent","useActiveElement","current","useCurrentElement","previouslyFocusedElement","computed","get","isFocused","_a","contains","set","target","focus","blur"],"mappings":"oJAIA,MAeaA,aAAgBC,IAC3B,MAAMC,EAhBiB,MACvB,MAAMC,EAAWC,IAEXC,oBAAsB,KAC1BF,EAASG,MAAQC,SAASC,eAQrB,OALPC,EAAUJ,qBAEVK,EAAgB,QAASL,qBACzBK,EAAgB,OAAQL,qBAEjBF,GAISQ,GACVC,EAAUC,EAAkBZ,GAElC,IAAIa,EAA+C,KAEnD,OAAOC,EAA8B,CACnCC,YACM,IAACd,EAAQI,MAAgB,OAAA,EACzB,GAAAJ,EAAQI,QAAUM,EAAQN,MAAgB,OAAA,EAE9C,MAAMW,EAAY,OAAAC,EAAAN,EAAQN,YAAR,EAAAY,EAAeC,SAASjB,EAAQI,OAE3C,OADHW,IAAaH,EAA2BZ,EAAQI,OAC7CW,GAETG,IAAKd,GACG,MAAAe,QAASP,IAA4BF,EAAQN,MAC/CA,EACM,MAAAe,GAAAA,EAAAC,QAEA,MAAAD,GAAAA,EAAAE"}