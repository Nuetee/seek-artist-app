{"version":3,"file":"VaDropdown.js","sources":["../../../../../src/components/va-dropdown/VaDropdown.vue"],"sourcesContent":["<template>\n  <div class=\"va-dropdown\" :class=\"computedClass\">\n    <div\n      ref=\"anchorRef\"\n      class=\"va-dropdown__anchor\"\n      role=\"button\"\n      aria-label=\"toggle dropdown\"\n      :aria-disabled=\"$props.disabled\"\n      :aria-expanded=\"!!valueComputed\"\n      :aria-controls=\"idComputed\"\n      @click=\"onAnchorClick\"\n      @mouseenter=\"onMouseEnter\"\n      @mouseleave=\"onMouseLeave\"\n    >\n      <slot name=\"anchor\" />\n    </div>\n    <template v-if=\"valueComputed\">\n      <teleport :to=\"attachElement\" :disabled=\"disableAttachment\">\n        <div\n          ref=\"contentRef\"\n          class=\"va-dropdown__content-wrapper\"\n          :id=\"idComputed\"\n          @mouseover=\"$props.isContentHoverable && onMouseEnter()\"\n          @mouseout=\"onMouseLeave\"\n          @click.stop=\"emitAndClose('dropdown-content-click', closeOnContentClick)\"\n        >\n          <slot />\n        </div>\n      </teleport>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType, shallowRef, toRef } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport { generateUniqueId } from '../../services/utils'\n\nimport {\n  useStateful, useStatefulEmits, useStatefulProps,\n  useDebounceFn,\n  usePopover, placementsPositions, Placement,\n  useClickOutside,\n  useBem,\n} from '../../composables'\n\nexport default defineComponent({\n  name: 'VaDropdown',\n\n  props: {\n    ...useStatefulProps,\n    stateful: { default: true },\n    modelValue: { type: Boolean, default: false },\n    disabled: { type: Boolean },\n    readonly: { type: Boolean },\n    anchorSelector: { type: String, default: '' },\n    attachElement: { type: String, default: 'body' },\n    disableAttachment: { type: Boolean, default: false },\n    keepAnchorWidth: { type: Boolean, default: false },\n    isContentHoverable: { type: Boolean, default: true },\n    closeOnContentClick: { type: Boolean, default: true },\n    closeOnClickOutside: { type: Boolean, default: true },\n    closeOnAnchorClick: { type: Boolean, default: true },\n    hoverOverTimeout: { type: Number, default: 30 },\n    hoverOutTimeout: { type: Number, default: 200 },\n    offset: { type: [Array, Number] as PropType<number | [number, number]>, default: 0 },\n    trigger: {\n      type: String as PropType<'click' | 'hover' | 'none'>,\n      default: 'click',\n      validator: (value: string) => ['click', 'hover', 'none'].includes(value),\n    },\n    placement: {\n      type: String as PropType<Placement>,\n      default: 'bottom',\n      validator: (value: string) => placementsPositions.includes(value),\n    },\n  },\n\n  emits: [...useStatefulEmits, 'anchor-click', 'dropdown-content-click', 'click-outside'],\n\n  setup (props, { emit }) {\n    const anchorRef = shallowRef<HTMLElement>()\n    const contentRef = shallowRef<HTMLElement>()\n\n    const { valueComputed: statefulVal } = useStateful(props, emit)\n    const valueComputed = computed({\n      get: () => statefulVal.value && !props.disabled && !props.readonly,\n      set (val) { statefulVal.value = val },\n    })\n\n    const computedClass = useBem('va-dropdown', () => pick(props, ['disabled']))\n\n    // to be able to select specific anchor element inside anchorRef\n    const computedAnchorRef = computed(() => (\n      anchorRef.value && props.anchorSelector\n        ? anchorRef.value.querySelector(props.anchorSelector) || anchorRef.value\n        : anchorRef.value\n      ) as HTMLElement | undefined)\n\n    usePopover(computedAnchorRef, contentRef, computed(() => ({\n      placement: props.placement,\n      keepAnchorWidth: props.keepAnchorWidth,\n      offset: props.offset,\n      stickToEdges: true,\n      autoPlacement: true,\n      root: props.attachElement,\n    })))\n\n    const { debounced: debounceHover, cancel: cancelHoverDebounce } = useDebounceFn(toRef(props, 'hoverOverTimeout'))\n    const onMouseEnter = () => {\n      if (props.trigger !== 'hover' || props.disabled) { return }\n\n      debounceHover(() => { valueComputed.value = true })\n      cancelUnHoverDebounce()\n    }\n\n    const { debounced: debounceUnHover, cancel: cancelUnHoverDebounce } = useDebounceFn(toRef(props, 'hoverOutTimeout'))\n    const onMouseLeave = () => {\n      if (props.trigger !== 'hover' || props.disabled) { return }\n\n      if (props.isContentHoverable) {\n        debounceUnHover(() => { valueComputed.value = false })\n      } else {\n        valueComputed.value = false\n      }\n      cancelHoverDebounce()\n    }\n\n    const emitAndClose = (eventName: string, close?: boolean) => {\n      emit(eventName)\n      if (close) { valueComputed.value = false }\n    }\n\n    const onAnchorClick = () => {\n      if (props.trigger !== 'click' || props.disabled) { return }\n\n      if (valueComputed.value) {\n        emitAndClose('anchor-click', props.closeOnAnchorClick)\n      } else {\n        valueComputed.value = true\n        emit('anchor-click')\n      }\n    }\n\n    useClickOutside([anchorRef, contentRef], () => {\n      if (props.closeOnClickOutside && valueComputed.value) {\n        emitAndClose('click-outside', props.closeOnClickOutside)\n      }\n    })\n\n    const idComputed = computed(generateUniqueId)\n\n    return {\n      valueComputed,\n      anchorRef,\n      contentRef,\n      computedClass,\n      emitAndClose,\n      onAnchorClick,\n      onMouseEnter,\n      onMouseLeave,\n      idComputed,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import '../../styles/resources';\n@import 'variables';\n\n.va-dropdown {\n  /* Solved the alignment problem (if we try to align inline and block elements) */\n  line-height: var(--va-dropdown-line-height);\n  font-family: var(--va-font-family);\n\n  &--disabled {\n    @include va-disabled;\n  }\n\n  &__content-wrapper {\n    /* overflow: hidden; */\n    z-index: var(--va-dropdown-content-wrapper-z-index);\n    font-family: var(--va-font-family);\n  }\n}\n</style>\n"],"names":["pick","_createElementBlock","_normalizeClass","_createElementVNode","_renderSlot","_openBlock","_createBlock","_Teleport","_withModifiers"],"mappings":"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"}